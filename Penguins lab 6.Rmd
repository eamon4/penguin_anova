---
title: "Lab_6_Penguin_ANOVA"
author: "Eamon Devlin"
date: "11/6/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Load packages and read in penguin data
```{r, include= FALSE}
library(tidyverse)
library(car)
library(onewaytests)

penguins <- read.csv("penguins.csv")
```

Our question

Is there a significant difference in mean flipper length for female penguins by species (Chinstrap, Gentoo, and Adelie)?

2. Do some exploring

New functions: with + table for easy counting over multiple factors

Update the species name using case_when

```{r}

counts <- with(penguins, table(species, sex))

counts

penguins2 <- penguins %>% 
  mutate(common_name =
           case_when(
             species == "Chinstrap penguin (Pygoscelis antarctica)" ~"Chinstrap", 
             species == "Gentoo penguin (Pygoscelis papua)" ~ "Gentoo",
             species == "Adelie Penguin (Pygoscelis adeliae)" ~ "Adelie")) %>% 
           select(-species) %>% 
           filter(sex == "FEMALE")
```

- Exploratory graphs
- Summary statistics
- Levene's tests for equal variances
- One way ANOVA
-post-hoc testing

```{r}

hists <- ggplot(penguins2, aes(x = flipper_length)) +
  geom_histogram(aes(fill = common_name))

hists

qqs <- ggplot(penguins2, aes(sample = flipper_length)) +
  geom_qq(aes(fill = common_name)) +
  facet_wrap( ~ common_name)

qqs


# LEVINE'S TEST FOR EQUAL VARIENCES (for 2 groups use f test)

# We'll use the function leveneTest from the 'car' package

# H0 variances are equal
# HA variences are different

penguin_Levene <- leveneTest(flipper_length ~ common_name, data = penguins2)

penguin_Levene

# We retain the null hypothesis of equal variances ( p = 0.06)

penguin_var <- penguins2 %>% 
  group_by(common_name) %>% 
  summarize(varience = var(flipper_length))

penguin_var

# Variances are close enough for an ANOVA
```


